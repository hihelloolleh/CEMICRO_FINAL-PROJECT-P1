FINALPROJ.lst - generated by MGTEK Assembler ASM11 V1.26 Build 144 for WIN32 (x86) - Wed Nov 19 14:23:40 2025

    1:                                 ; HC11 Final Project Phase 1 - EPROM Reader (First 25 Bytes)
    2:                                 ; Based on lecture hardware mapping:
    3:                                 ; Port B -> EPROM Address (A0-A7)
    4:                                 ; Port C -> EPROM Data (D0-D7)
    5:                                 ; Port A -> EPROM Control (CE/OE) - Using PA6 (Bit 6) as Control
    6:                                 
    7:          =00000000                      ORG     $0000           ; RAM Start for Bootstrap Mode
    8:                                 
    9:          =00001000              BASE    EQU     $1000           ; Register Base Address
   10:          =00000000              PORTA   EQU     $00             ; Port A
   11:          =00000003              PORTC   EQU     $03             ; Port C
   12:          =00000004              PORTB   EQU     $04             ; Port B
   13:          =00000007              DDRC    EQU     $07             ; Data Direction Register C
   14:          =0000002E              SCSR    EQU     $2E             ; Serial Comm Status Register
   15:          =0000002F              SCDR    EQU     $2F             ; Serial Comm Data Register
   16:                                 
   17:     0000                        START:
   18:     0000 8E 00FF                        LDS     #$00FF          ; Initialize Stack Pointer to top of RAM
   19:     0003 CE 1000                        LDX     #BASE           ; Point Index Register X to Register Block
   20:                                 
   21:                                         ; 1. Configure Ports based on transcript
   22:     0006 6F 07                          CLR     DDRC,X          ; Set DDRC to 0 -> Port C becomes INPUT (Read EPROM Data)
   23:                                                                 ; Port B is Output-only by default (EPROM Address)
   24:                                                                 ; Port A Bit 6 is Output by default (Control)
   25:                                         
   26:     0008 1C 00 40                       BSET    PORTA,X $40     ; Set PA6 HIGH (Disable EPROM Output initially)
   27:                                                                 ; Assuming Active Low logic for OE/CE
   28:                                 
   29:     000B 5F                             CLRB                    ; Accumulator B will act as our Loop Counter & Address
   30:                                                                 ; (Counts 0 to 25)
   31:                                 
   32:     000C                        READ_LOOP:
   33:     000C C1 19                          CMPB    #25             ; Check if we have read 25 bytes
   34:     000E 27 15                          BEQ     DONE            ; If B == 25, we are finished
   35:                                 
   36:                                         ; 2. Set Address
   37:     0010 E7 04                          STAB    PORTB,X         ; Output current count (B) to Port B (EPROM Address)
   38:                                 
   39:                                         ; 3. Control Signal (Pulse OE/CE Low)
   40:     0012 1D 00 40                       BCLR    PORTA,X $40     ; Clear PA6 -> Low (Enable EPROM Output)
   41:                                         
   42:     0015 01                             NOP                     ; Short delay for EPROM access time (tACC)
   43:     0016 01                             NOP                     ; (HC11 is fast, EPROM might be slow)
   44:                                 
   45:                                         ; 4. Read Data
   46:     0017 A6 03                          LDAA    PORTC,X         ; Read EPROM data from Port C into Accumulator A
   47:                                 
   48:                                         ; 5. Disable EPROM
   49:     0019 1C 00 40                       BSET    PORTA,X $40     ; Set PA6 -> High (Disable EPROM Output)
   50:                                 
   51:                                         ; 6. Send Data to PC via Serial (SCI)
   52:                                         ; Note: Baud rate is already set by the Bootloader process before this runs
   53:     001C                        TX_WAIT:
   54:     001C 1F 2E 80 FC                    BRCLR   SCSR,X $80 TX_WAIT ; Wait until TDRE (Transmit Data Reg Empty) bit is set
   55:     0020 A7 2F                          STAA    SCDR,X          ; Send the byte in Acc A to Serial
   56:                                 
   57:     0022 5C                             INCB                    ; Increment Loop Counter / Address
   58:     0023 20 E7                          BRA     READ_LOOP       ; Repeat
   59:                                 
   60:     0025                        DONE:
   61:     0025 20 FE                          BRA     DONE            ; Infinite loop to stop execution
